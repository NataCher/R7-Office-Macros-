(function() {
    var mailto = "example@example.com"; // Адрес получателя
    var subject = "Документ из Р7-офис"; // Тема письма
    var body = "Здравствуйте,\n\nВо вложении документ из Р7-офис.\n\nС уважением,\nВаша команда"; 

    // Получаем текущий документ
    var document = Api.GetDocument();
    var docUrl = document.GetUrl();

    // Создаем письмо
    var message = {
        to: mailto,
        subject: subject,
        body: body,
        attachments: [{
            name: document.GetTitle() + ".docx",
            content: docUrl
        }]
    };

    // Отправляем письмо
    Api.SendMail(message, function(response) {
        if (response.status === "success") {
            Api.ShowMessage("Успех", "Письмо успешно отправлено.");
        } else {
            Api.ShowMessage("Ошибка", "Ошибка при отправке письма: " + response.error);
        }
    });
})();
