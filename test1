function sendEmail() {
  try {
    // Получаем текущий активный документ Excel
    var excelApp = new ActiveXObject("Excel.Application");
    var excelWorkbook = excelApp.ActiveWorkbook;

    if (!excelWorkbook) {
      alert("Откройте документ Excel перед запуском макроса.");
      return;
    }

    // Создаем объект для доступа к Outlook
    var outlookApp = new ActiveXObject("Outlook.Application");
    var mailItem = outlookApp.CreateItem(0); // Создаем новое письмо

    // Заполняем поля письма
    mailItem.Subject = "Отправка документа Excel";
    mailItem.Body = "Документ Excel для вас.";
    mailItem.To = "recipient@example.com"; // Укажите адрес получателя

    // Прикрепляем текущий документ Excel к письму
    var attachment = excelWorkbook.FullName;
    mailItem.Attachments.Add(attachment);

    // Отправляем письмо
    mailItem.Send();

    // Закрываем Excel после отправки письма
    excelApp.Quit();
  } catch (err) {
    alert("Произошла ошибка: " + err.message);
  }
}

